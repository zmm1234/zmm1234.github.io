<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2">






<meta name="description" content="record tech &amp; life">
<meta property="og:type" content="website">
<meta property="og:title" content="Submarine">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Submarine">
<meta property="og:description" content="record tech &amp; life">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Submarine">
<meta name="twitter:description" content="record tech &amp; life">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>Submarine</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Submarine</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">chinese submarine</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/15/tutoial-of-hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="三闻鱼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Submarine">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/15/tutoial-of-hexo/" itemprop="url">利用Hexo+Github搭建个人免费博客</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-15T14:41:24+08:00">
                2019-02-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本篇blog将记录个人静态博客的搭建方法,包括：</p>
<ul>
<li>Github静态博客是什么，为什么选择Hexo？</li>
<li>Hexo搭建过程</li>
<li>Hexo使用方法</li>
</ul>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/02/15/tutoial-of-hexo/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/30/QT项目性能调优小记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="三闻鱼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Submarine">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/05/30/QT项目性能调优小记/" itemprop="url">QT项目性能调优小记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-30T22:53:00+08:00">
                2016-05-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近的项目用到了QT 5.5，项目在运行过程中出现了一段时间CPU占用率持续25%，并频繁断网的情况，遂决定对项目性能进行优化。</p>
<p>优化工具也是VS2010自带的性能分析工具，具体的使用方法参见：<a href="http://www.cnblogs.com/smark/archive/2011/10/12/2208039.html" title="http://www.cnblogs.com/smark/archive/2011/10/12/2208039.html" target="_blank" rel="noopener">http://www.cnblogs.com/smark/archive/2011/10/12/2208039.html</a></p>
<p>其中可以选择‘just my code’过滤出自己编写的代码。</p>
<p>通过性能分析工具可以找到占用CPU时间较多的函数，然后按照占有时间多少进行优化&gt;再分析&gt;再优化的步骤，多次优化后，将CPU占用率降到了2%以下。下面将对性能优化提升较大的几个优化步骤进行记录： </p>
<h3 id="1-优化字符串格式化方法。"><a href="#1-优化字符串格式化方法。" class="headerlink" title="1.优化字符串格式化方法。"></a>1.优化字符串格式化方法。</h3><p>项目中有将QByteArray中的二进制数如&rdquo;123&rdquo;格式化成&rdquo;31, 32, 33&rdquo;的功能，使用的代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">QByteArray msg = xxx</span><br><span class="line"></span><br><span class="line">QString  str;</span><br><span class="line"></span><br><span class="line">foreach (quint8 b, msg)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    str.append(QString().<span class="built_in">sprintf</span>(“%<span class="number">02</span>X”, b));</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当msg中包含6，7w个字符时，在lz酷睿2代i5的机器上，这段代码需要执行4到5s，因为其中的QString会调用new函数6，7w此，对性能影响极大。优化后的代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QString  <span class="title">buildString</span><span class="params">(<span class="keyword">const</span> QByteArray&amp; ba)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> ascii[] = &#123;‘<span class="number">0</span>’, ‘<span class="number">1</span>’, 	‘<span class="number">2</span>’,‘<span class="number">3</span>’,‘<span class="number">4</span>’,‘<span class="number">5</span>’,‘<span class="number">6</span>’,‘<span class="number">7</span>’,‘<span class="number">8</span>’,‘<span class="number">9</span>’,‘A’,‘B’,‘C’,‘D’,	‘E’,‘F’&#125;;</span><br><span class="line"></span><br><span class="line">	QString buf;</span><br><span class="line"></span><br><span class="line">	buf.resize(ba.length() * <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	foreach (quint8 b, ba)</span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">    	buf[i] = ascii[b &gt;&gt; <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">    	buf[i + <span class="number">1</span>] =ascii[b &amp; <span class="number">0xF</span>];</span><br><span class="line"></span><br><span class="line">    	buf[i + <span class="number">2</span>] = ‘, ’;</span><br><span class="line"></span><br><span class="line">    	i += <span class="number">3</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (i &gt; <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    	i –= <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">	buf[i] = ‘\<span class="number">0</span>’;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> buf;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<p>重新运行后，CPU耗时120ms左右，性能提升了几十倍。</p>
<h3 id="2-优化界面刷新"><a href="#2-优化界面刷新" class="headerlink" title="2.优化界面刷新"></a>2.优化界面刷新</h3><p>在界面功能中有一处表格显示的功能，显示接收到的数据，在原始的代码中，当接收到一条数据，填充到表格上时，就调用一次表格scrollTo方法，当1s接收到2，3百条数据时，就会调用2，3此scrollTo方法，直接导致了界面频繁更新。</p>
<p>优化的方法是，考虑到人眼的观察能力，将刷新频率即scrollTo的函数调用固定为1s一次，减少了2，3百此的界面重绘，降低了CUP负载。</p>
<h3 id="3-优化更新时戳功能"><a href="#3-优化更新时戳功能" class="headerlink" title="3.优化更新时戳功能"></a>3.优化更新时戳功能</h3><p>项目中有一处更新时戳的功能，记录某些状态是否已经超时，原始代码中通过QDateTime记录时戳，当数据到来时会调用QDateTime：：currentDateTime更新时戳，当有大量数据到来时会频繁更新时戳，通过性能分析发现此处调用总CPU使用率的7%。考虑该时戳只需要统计时间间隔，遂优化后改用time.h中的clock函数打时戳，该函数返回至程序启动的毫秒数。再次进行性能分析显示此处调用降到CPU使用率的0.23%，性能提升明显。</p>
<h3 id="4-优化数据库操作"><a href="#4-优化数据库操作" class="headerlink" title="4.优化数据库操作"></a>4.优化数据库操作</h3><p>项目中有一处数据库记录update操作，将QByteArray更新到数据库中，程序中使用了QT中的储存过程API，将QByteArray变量绑定到QSqlQuery对象上，参考代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QSqlQuery <span class="title">query</span><span class="params">(db)</span></span>;</span><br><span class="line"></span><br><span class="line">QByteArray data;</span><br><span class="line"></span><br><span class="line">query.prepare(“update table <span class="built_in">set</span> data = ? where id = ?”);</span><br><span class="line"></span><br><span class="line">query.bindValue(<span class="number">0</span>, data);</span><br><span class="line"></span><br><span class="line">query.bindValue(<span class="number">1</span>, id);</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<p>其中data中包含6，7w个数据，其中发现程序在query.bindValue(data)上耗时最多，打印日志发现该data中的内容必定为可显示的ascii，遂将代码改为</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query.bindValue(<span class="number">0</span>, QString(data));</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<p>减少了QByteArray转换成QString的时间。</p>
<h3 id="5-其他"><a href="#5-其他" class="headerlink" title="5.其他"></a>5.其他</h3><p>其他优化还包括数据结构的调整，包括将2，3百条数据的数组改成map结构储存等。</p>
<p>&nbsp;</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>当然对软件的优化还是用遵循相应的原则，比如不要过早优化，在项目的初期以代码的稳定性，可读性，可扩展性为主要目标，只有当代码的性能不能满足需求时再进行适当的优化。因为往往对代码的优化会牺牲以上三个特效，所以在软件开发过程中，经常需要平衡这些特性。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/08/28/Windows下HG服务器的搭建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="三闻鱼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Submarine">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/08/28/Windows下HG服务器的搭建/" itemprop="url">Windows下HG服务器的搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-08-28T23:41:00+08:00">
                2015-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-环境和所需工具安装"><a href="#1-环境和所需工具安装" class="headerlink" title="1.环境和所需工具安装"></a>1.环境和所需工具安装</h3><p>1. 安装python-2.7.9.exe</p>
<p>2. 安装mercurial-3.2.3.win32-py2.7.exe</p>
<p>3. 安装mercurial-3.2.3-x86.msi</p>
<p>4. 安装tortoisehg-3.3.2-x64或者tortoisehg-3.3.2-x86</p>
<p>5. 安装windows iis</p>
<h3 id="2-操作步骤"><a href="#2-操作步骤" class="headerlink" title="2.操作步骤"></a>2.操作步骤</h3><p>1. 搭建网站，新建文件夹D:/hgweb</p>
<p>2. 在 IIS 中新建一个网站，名称是 hgweb，物理路径指向上一步的D:/hgweb</p>
<p>3. 在 IIS 中选择刚才新建的网站，右侧的功能视图中选择 &ldquo;处理程序映射&rdquo;，如下图</p>
<p><a href="http://images0.cnblogs.com/blog/28698/201508/282339437033088.gif" target="_blank" rel="noopener"><img src="http://images0.cnblogs.com/blog/28698/201508/282339444377946.gif" alt="clip_image002" title="clip_image002"></a></p>
<p><a href="http://images0.cnblogs.com/blog/28698/201508/282339447811518.gif" target="_blank" rel="noopener"><img src="http://images0.cnblogs.com/blog/28698/201508/282339451562332.gif" alt="clip_image004" title="clip_image004"></a></p>
<p>IIS 7.0以上的写法</p>
<p><a href="http://images0.cnblogs.com/blog/28698/201508/282339454065875.jpg" target="_blank" rel="noopener"><img src="http://images0.cnblogs.com/blog/28698/201508/282339456877661.jpg" alt="clip_image005" title="clip_image005"></a></p>
<p>IIS 6.0的写法</p>
<p>4. 在D:\hgweb下新建一个文本文件, 重命名为test.cgi (注意连同扩展名一起修改) , 编辑其内容如下:</p>
<p>print ‘Status: 200 OK’</p>
<p>print ‘Content-Type: text/html’</p>
<p>print</p>
<p>print ‘&lt;html&gt;&lt;body&gt;&lt;h1&gt;It Works!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;’</p>
<p>保存, 然后在IIS中浏览test.cgi:</p>
<p>url: <a href="http://localhost/hg/test.cgi" target="_blank" rel="noopener">http://localhost/hg/test.cgi</a></p>
<p>界面:</p>
<p><a href="http://images0.cnblogs.com/blog/28698/201508/282339462506532.jpg" target="_blank" rel="noopener"><img src="http://images0.cnblogs.com/blog/28698/201508/282339465944806.jpg" alt="clip_image006" title="clip_image006"></a></p>
<p>如果能看到上述界面, 说明初期配置成功,继续.</p>
<p>如果提示HTTP 错误 404.2 - Not Found</p>
<p>由于 Web 服务器上的&ldquo;ISAPI 和 CGI 限制&rdquo;列表设置，无法提供您请求的页面</p>
<p>打开IIS管理器, 定位到服务器级别, 在其功能列表中找到ISAPI and CGI restrictions, 如图:</p>
<p><a href="http://images0.cnblogs.com/blog/28698/201508/282339469534148.jpg" target="_blank" rel="noopener"><img src="http://images0.cnblogs.com/blog/28698/201508/282339472199163.jpg" alt="clip_image007" title="clip_image007"></a></p>
<p>双击打开, 里面必须存在如下图所示的行:</p>
<p><a href="http://images0.cnblogs.com/blog/28698/201508/282339476404992.jpg" target="_blank" rel="noopener"><img src="http://images0.cnblogs.com/blog/28698/201508/282339479226778.jpg" alt="clip_image008" title="clip_image008"></a></p>
<p>如果不存在则按点击右侧的&rdquo;add&rdquo;, 按下图填写:</p>
<p><a href="http://images0.cnblogs.com/blog/28698/201508/282339482033863.jpg" target="_blank" rel="noopener"><img src="http://images0.cnblogs.com/blog/28698/201508/282339485153893.jpg" alt="clip_image009" title="clip_image009"></a></p>
<p>如果已存在, 但是被禁用, 将其启用即可.</p>
<p>完成后重试打开test.cgi, 应该可以看到it works字样.</p>
<p>5. 在D:\hgweb目录下新建一个文本文件, 重命名为hgweb.cgi, 编辑其内容为以下几句话:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># An example hgweb CGI script, edit as necessary</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># See also http://mercurial.selenic.com/wiki/PublishingRepositories</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Path to repo or hgweb config to serve (see 'hg help hgweb')</span></span><br><span class="line"></span><br><span class="line">config = <span class="string">"D:/hgweb/hgweb.config"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Uncomment and adjust if Mercurial is not installed system-wide:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#import sys; sys.path.insert(0, "/path/to/python/lib")</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Uncomment to send python tracebacks to the browser if an error occurs:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#import cgitb; cgitb.enable()</span></span><br><span class="line"></span><br><span class="line">from mercurial import demandimport; demandimport.enable()</span><br><span class="line"></span><br><span class="line">from mercurial.hgweb import hgweb, wsgicgi</span><br><span class="line"></span><br><span class="line">application = hgweb(config)</span><br><span class="line"></span><br><span class="line">wsgicgi.launch(application)</span><br></pre></td></tr></table></figure>
<p>然后再在D:\Mercurial下新建一个文本文件, 重命名为hgweb.config, 不需要写入任何内容, 即可尝试浏览<a href="http://localhost/hg/hgweb.cgi" target="_blank" rel="noopener">http://localhost:8080 /hgweb.cgi</a> . 应该能看到如下界面:</p>
<p><a href="http://images0.cnblogs.com/blog/28698/201508/282339488904707.jpg" target="_blank" rel="noopener"><img src="http://images0.cnblogs.com/blog/28698/201508/282339491408250.jpg" alt="clip_image010" title="clip_image010"></a></p>
<p>6. 修改hgweb.config</p>
<table border="1" cellspacing="0" cellpadding="0"><br><tbody><br><tr><br><td valign="top" width="568"><br><br>[paths]<br><br>/Repositories/ = E:/myweb/<em><br><br>[web]<br><br>baseurl = /hgweb.cgi<br><br>allow_push = </em><br><br>push_ssl = false<br><br></td><br></tr><br></tbody><br></table>

<p>7. 创建代码仓库</p>
<p>在D:/hgweb下面创建test文件夹，在文件夹中执行创建hg create</p>
<p><a href="http://images0.cnblogs.com/blog/28698/201508/282339493902793.jpg" target="_blank" rel="noopener"><img src="http://images0.cnblogs.com/blog/28698/201508/282339496563107.jpg" alt="clip_image012" title="clip_image012"></a></p>
<p>再次访问hgweb.cgi，可以看到如下图的画面：</p>
<p><a href="http://images0.cnblogs.com/blog/28698/201508/282339499066650.jpg" target="_blank" rel="noopener"><img src="http://images0.cnblogs.com/blog/28698/201508/282339501878436.jpg" alt="clip_image014" title="clip_image014"></a></p>
<p>8. 同步</p>
<p>在要同步的电脑上输入hg clone</p>
<p><a href="http://images0.cnblogs.com/blog/28698/201508/282339504846993.jpg" target="_blank" rel="noopener"><img src="http://images0.cnblogs.com/blog/28698/201508/282339507507307.jpg" alt="clip_image016" title="clip_image016"></a></p>
<p>9. 提交代码</p>
<p>修改文件后，在设置中将用户名设置为提交用户名</p>
<p><a href="http://images0.cnblogs.com/blog/28698/201508/282339510945580.jpg" target="_blank" rel="noopener"><img src="http://images0.cnblogs.com/blog/28698/201508/282339513752665.jpg" alt="clip_image018" title="clip_image018"></a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/08/10/svn-tp-link-花生壳搭建外网服务器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="三闻鱼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Submarine">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/08/10/svn-tp-link-花生壳搭建外网服务器/" itemprop="url">svn+tp-link+花生壳搭建外网服务器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-08-10T22:59:00+08:00">
                2011-08-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="nbsp"><a href="#nbsp" class="headerlink" title="&nbsp;"></a>&nbsp;</h3><h3 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1.准备工作"></a>1.准备工作</h3><p>1.下载svn客户端和svn服务器</p>
<p>可以去<a href="http://subversion.apache.org/packages.html" target="_blank" rel="noopener">http://subversion.apache.org/packages.html</a> 找到自己平台的客户端和服务器。</p>
<p>因为笔者的平台是windows，所以选择了<a href="http://tortoisesvn.net/" target="_blank" rel="noopener">TortoiseSVN</a>和<a href="http://sourceforge.net/projects/win32svn/" target="_blank" rel="noopener">Win32Svn</a>。</p>
<p>2.安装<a href="http://www.oray.com/peanuthull/" target="_blank" rel="noopener">花生壳</a></p>
<p>去官网下载花生壳软件，并申请护照，就可以得到一个二级域名，这里就不累述了。</p>
<h3 id="2-网络的搭建"><a href="#2-网络的搭建" class="headerlink" title="2.网络的搭建"></a>2.网络的搭建</h3><p>由于笔者的网络是通过路由器联网，所以需要将路由的端口映射到内网的ip。针对tp-link路由，具体的步骤是：</p>
<p>1.进入管理员页面。</p>
<p>2.设置IP与MAC地址绑定。当然这项也可以不设，不过因为内外IP会变，所以可能每次都要设置，很麻烦。</p>
<p>3.设置虚拟服务器。将端口号映射到自己的ip地址。</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chinese-zmm/201108/201108102254256746.png" target="_blank" rel="noopener"><img src="http://images.cnblogs.com/cnblogs_com/chinese-zmm/201108/201108102254263582.png" alt="image" title="image"></a></p>
<p>此处设置端口号为3690 是因为svnserve默认使用的是3690端口。</p>
<p>4.通过花生壳设置DDNS，填入之前申请到的花生壳用户名和地址。</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chinese-zmm/201108/201108102254301758.png" target="_blank" rel="noopener"><img src="http://images.cnblogs.com/cnblogs_com/chinese-zmm/201108/201108102254321069.png" alt="image" title="image"></a></p>
<p>NOTE：如果登录不了，一般有两个解决方法：1.刷新路由的韧体。2.选择另外一个服务提供者。</p>
<p>5.登入花生壳</p>
<p>在本机登录花生壳。如果看到花生壳软件的右下方有一个ip地址和自己路由的ip地址一致的话，那么就表明配置成功了。如果不一样，可能需要等待一会，因为DDNS的设置需要一些时间。</p>
<p>*</p>
<h3 id="3-svn的配置"><a href="#3-svn的配置" class="headerlink" title="3.svn的配置"></a>3.svn的配置</h3><p>1.创建代码库</p>
<p>可以通过两种方式：</p>
<p>(a).安装完<a href="http://tortoisesvn.net/" target="_blank" rel="noopener">TortoiseSVN</a>后，在鼠标右键的快捷方式下，就会有一个create repository here的选项，在一个空文件夹下，执行此条命令就会自动创建一个repository。</p>
<p>(b).在<a href="http://sourceforge.net/projects/win32svn/" target="_blank" rel="noopener">Win32Svn</a>安装目录的bin文件夹下，找到svnadmin可执行档，键入：</p>
<blockquote>
<p>svnadmin create &lt;<em>folder path</em>&gt;</p>
</blockquote>
<p>关于代码库更详细的配置方式，可以参考：<a href="http://blog.163.com/cp7618@yeah/blog/static/70234777201108105751174/" target="_blank" rel="noopener">http://blog.163.com/cp7618@yeah/blog/static/70234777201108105751174/</a></p>
<p>2.导入项目</p>
<p>具体的步骤可以参考《Subversion 1.6 权威指南》。</p>
<h3 id="4-运行svn"><a href="#4-运行svn" class="headerlink" title="4.运行svn"></a>4.运行svn</h3><p>在<a href="http://sourceforge.net/projects/win32svn/" target="_blank" rel="noopener">Win32Svn</a>安装目录的bin文件夹下，找到svnserve，键入：</p>
<blockquote>
<p><span color="#4b4b4b" style="color: #4b4b4b;">svnserve &ndash;d &ndash;r &lt;repository path&gt; </span>–listen-port 3690</p>
</blockquote>
<h3 id="5-远程访问"><a href="#5-远程访问" class="headerlink" title="5.远程访问"></a>5.远程访问</h3><p>在远程的PC上，打开<a href="http://tortoisesvn.net/" target="_blank" rel="noopener">TortoiseSVN</a>，输入svn://&lt;花生壳提供的免费域名&gt;即可访问到共享的项目。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/01/26/极大极小博弈树的简洁（附Tic-Tac-Toe源码）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="三闻鱼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Submarine">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/01/26/极大极小博弈树的简洁（附Tic-Tac-Toe源码）/" itemprop="url">极大极小博弈树的简介（附Tic-Tac-Toe源码）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-01-26T21:46:00+08:00">
                2011-01-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#简介</p>
<p>极大极小博弈树(<a href="http://en.wikipedia.org/wiki/Minimax" target="_blank" rel="noopener">Minimax Game Tree</a>)用于编写电脑之间的游戏程序，这类程序由两个游戏者轮流，每次执行一个步骤。当然，所有可能的步骤构成了一个树的结构。例如下面的图就是一个MGT，它表示了<a href="http://en.wikipedia.org/wiki/Tic-tac-toe" target="_blank" rel="noopener">Tic-Tac-Toe</a>游戏的前两步所有可能的步骤。</p>
<p><img src="http://www.aihorizon.com/images/essays/minimax-tictac.gif" alt></p>
<p>在每一层中的节点通常代表不同游戏者的选择，这两个游戏者通常被称作马克思（MAX）和米恩（Min）。</p>
<p>例如如果第二层是Max turn，则第三层就是Min turn，第二层的每个节点就是Max的choice，它们之间是或的关系，第三层的每个节点就是Min的choice，它们之间是与的关系。根据这个树，Max要做出的选择就让下次Min做出的任意选择都最小，即Minimax这个词的含义，极小化对手的最大收益。所以它不同于<a href="http://en.wikipedia.org/wiki/Minimax#Maximin" target="_blank" rel="noopener">Maximin</a>最大化自己的收益。</p>
<p>因为往往一局要下到最后才能分出胜负，而<a href="http://en.wikipedia.org/wiki/Game_tree" target="_blank" rel="noopener">Game Tree</a>上nodes的增长是以指数方式的，比如深蓝（Deep Blue）可以搜索12步，假设各方每步都有10种选择，那么一次的搜索量也有1万亿次，所以对于普通的电脑能够搜索到4步也有1万次了，所以就需要一个评分系统，对局面进行打分，考虑到是双人对战，则评分从负无穷到正无穷。所以马克思就是要找到一个最大的分数，而米恩就是要找到一个最小的分数。</p>
<p>#例子</p>
<p>下面用一个例子来说明，Tic-Tac-Toe游戏。</p>
<p>其中&lsquo;o&rsquo;代表PC，&lsquo;x&rsquo;代表玩家。</p>
<p>其中有三个主要的函数：</p>
<p>int minSearch( char _board[9] ) </p>
<p>int maxSearch( char _board[9] )</p>
<p>int gameState(char _board[9])</p>
<p>分别扮演max和min的角色，寻找最大和最小值，以及一个评分函数。</p>
<p>下面重点说说这个游戏的核心部分，gameState评分函数：</p>
<p>连三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 100分</p>
<p>双连二&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 50分</p>
<p>平局&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0分</p>
<p>不分胜负&nbsp;&nbsp;&nbsp;&nbsp; 1</p>
<p>其中如果评分时不分胜负则还会继续搜索，直到找到其他三种状态。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gameState</span><span class="params">(<span class="keyword">char</span> _board[<span class="number">9</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> state;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> table[][<span class="number">3</span>] = </span><br><span class="line">    &#123;</span><br><span class="line">        &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;,</span><br><span class="line">        &#123;<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;,</span><br><span class="line">        &#123;<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>&#125;,</span><br><span class="line">        &#123;<span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>&#125;,</span><br><span class="line">        &#123;<span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>&#125;,</span><br><span class="line">        &#123;<span class="number">0</span>, <span class="number">4</span>, <span class="number">8</span>&#125;,</span><br><span class="line">        &#123;<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>&#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">char</span> chess = _board[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> i = <span class="number">1</span>; i &lt; <span class="number">9</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        chess &amp;= _board[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> isFull = <span class="number">0</span> != chess;</span><br><span class="line">    <span class="keyword">bool</span> isFind = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(table) / <span class="keyword">sizeof</span>(<span class="keyword">int</span>[<span class="number">3</span>]); ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        chess = _board[table[i][<span class="number">0</span>]];</span><br><span class="line">        <span class="keyword">int</span> j;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt; <span class="number">3</span>; ++j)</span><br><span class="line">            <span class="keyword">if</span> (_board[table[i][j]] != chess)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (chess != empty &amp;&amp; j == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            isFind = <span class="literal">true</span>;        </span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (isFind)</span><br><span class="line">        <span class="comment">//got win or lose</span></span><br><span class="line">        state = chess == o ? WIN : LOSE;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (isFull)</span><br><span class="line">            <span class="comment">//all position has been set without win or lose</span></span><br><span class="line">            <span class="keyword">return</span> DRAW;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//finds[0] -&gt; 'o', finds[1] -&gt; 'x'</span></span><br><span class="line">            <span class="keyword">int</span> finds[<span class="number">2</span>] = &#123;<span class="number">0</span>, &#125;;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(table) / <span class="keyword">sizeof</span>(<span class="keyword">int</span>[<span class="number">3</span>]); ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">bool</span> findEmpty = <span class="literal">false</span>;</span><br><span class="line">                chess = <span class="number">0xff</span>;</span><br><span class="line">                <span class="keyword">int</span> j;</span><br><span class="line">                <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j)</span><br><span class="line">                    <span class="keyword">if</span> (_board[table[i][j]] == empty &amp;&amp; !findEmpty)</span><br><span class="line">                        findEmpty = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        chess &amp;= _board[table[i][j]];</span><br><span class="line">                <span class="keyword">if</span> ((chess == o || chess == x) &amp;&amp; findEmpty)</span><br><span class="line">                &#123;</span><br><span class="line">                    isFind = <span class="literal">true</span>;        </span><br><span class="line">                    <span class="keyword">if</span> (o == chess)</span><br><span class="line">                        ++finds[<span class="number">0</span>];</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        ++finds[<span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (finds[<span class="number">0</span>] &gt; <span class="number">1</span> &amp;&amp; finds[<span class="number">1</span>] &lt; <span class="number">1</span>)</span><br><span class="line">                <span class="comment">//2 'o' has been founded twice in row, column or diagonal direction</span></span><br><span class="line">                state = -(INFINITY / <span class="number">2</span>) * finds[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (finds[<span class="number">1</span>] &gt; <span class="number">1</span> &amp;&amp; finds[<span class="number">0</span>] &lt; <span class="number">1</span>)</span><br><span class="line">                <span class="comment">//2 'x' has been founded twice in row, column or diagonal direction</span></span><br><span class="line">                state = INFINITY / <span class="number">2</span> * finds[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="comment">//need to search more.</span></span><br><span class="line">                state = INPROGRESS;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后附上源码：<a href="http://files.cnblogs.com/chinese-zmm/Tic-Tac-Toe.7z" target="_blank" rel="noopener">http://files.cnblogs.com/chinese-zmm/Tic-Tac-Toe.7z</a></p>
<p>#Reference</p>
<p><a href="http://en.wikipedia.org/wiki/Minimax" target="_blank" rel="noopener">http://en.wikipedia.org/wiki/Minimax</a></p>
<p><a href="http://www.cnblogs.com/goodness/archive/2010/05/27/1745756.html" target="_blank" rel="noopener">http://www.cnblogs.com/goodness/archive/2010/05/27/1745756.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/01/19/程序优化小记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="三闻鱼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Submarine">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/01/19/程序优化小记/" itemprop="url">程序优化小记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-01-19T20:40:00+08:00">
                2011-01-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近做给一块蓝牙芯片做了一个decode的功能，数据是用RLE（<a href="http://en.wikipedia.org/wiki/Run-length_encoding" title="http://en.wikipedia.org/wiki/Run-length_encoding" target="_blank" rel="noopener">http://en.wikipedia.org/wiki/Run-length_encoding</a>）流程算法压缩的。为什么选用RLE算法，因为蓝牙芯片自身memory的局限性，最大只能获得不到2K的内存，还是不连续，而解压出的数据有2K多，所以需要一种能够边解压边发送的算法，查看现在流行的几种算法：霍夫曼算法，RLE算法，查表算法。</p>
<p>&nbsp;</p>
<table cellspacing="0" cellpadding="2" width="400" border="0"><br><tbody><br><tr><br><td valign="top" width="100">&nbsp;</td><br><td valign="top" width="100">压缩率</td><br><td valign="top" width="100">实现复杂度</td><br><td valign="top" width="100">内存占用量</td><br></tr><br><tr><br><td valign="top" width="100">霍夫曼算法</td><br><td valign="top" width="100">小</td><br><td valign="top" width="100">中</td><br><td valign="top" width="100">中</td><br></tr><br><tr><br><td valign="top" width="100">RLE算法</td><br><td valign="top" width="100">中</td><br><td valign="top" width="100">小</td><br><td valign="top" width="100">小</td><br></tr><br><tr><br><td valign="top" width="100">查表算法</td><br><td valign="top" width="100">大</td><br><td valign="top" width="100">大</td><br><td valign="top" width="100">大（一般几十K）</td><br></tr><br></tbody><br></table>

<p>&nbsp;</p>
<p>由于查表算法的内存占用量一般需要几十K，所以所以首先排除，而且比较霍夫曼算法和RLE算法，RLE算法在压缩率，实现复杂度，内存占用量三个方面都占有优势，所以最终选择RLE作为压缩和解码的方法。</p>
<p>花了几天时间实现了改算法，今天对其进行了性能测试，发现解压目标数据需要200多ms，遂决定对其进行优化。</p>
<p><strong>step1</strong>，还原行解压函数，减少一百多次的函数调用，但是实验的结果是反而增加了100多ms，猜测可能是有远指针调用，遂放弃。</p>
<p><strong>step2</strong>，将行解压函数中，对堆内存的访问换成对栈上数据的访问，实验下来时间减小到了70-80ms，性能提升了一倍多。</p>
<p><strong>step3</strong>，由于采用的RLE算法是经过改进过的，n + 1行的数据是和n行数据异或过，所以增加相同数据的几率，比如有三行数据时1010 1010，理论上是不能压缩的，当时经过异或，后面两行数据都变成了0000 0000，便可以采用RLE算法进行压缩。所以根据这一特性，在step3做的优化是，比较解压出的值，如果是0，则不需要和上一行的数据进行异或（因为任何数和零异或都不变）。改进后可以将时间减小到30-40ms，又提升了一倍多。</p>
<p><strong>step4</strong>，在step3的基础，在行解压算法中，如果检测到行的剩余部分都是0，则直接跳过该行剩下的部分。改进后时间减小到了十几个ms。</p>
<p>所以进过step2-4，性能提升了10倍多。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2010/12/13/Beating-the-Average-为什么要学习Lisp-转/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="三闻鱼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Submarine">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2010/12/13/Beating-the-Average-为什么要学习Lisp-转/" itemprop="url">Beating the Average------为什么要学习Lisp[转]</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2010-12-13T18:29:00+08:00">
                2010-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><span><span>出类拔萃</span></span></p>
<p>by Paul Graham</p>
<p>April 2001, rev. April 2003</p>
<p>（这篇文章改自<span>2001</span>年给<span>Franz</span>开发者论坛的演讲）</p>
<p><span>1995</span>年夏天，我和我的朋友<span>Robert Morris</span>创办了一个公司叫<span>Viaweb.&nbsp;</span>我们的计划是写一个在线商店的建站软件。当时这个软件的新颖之处是它在我们的服务器端运行，用网页作为用户界面。</p>
<p>当然，很多人当年也有同样的想法，但就我所知，<span>Viaweb</span>是第一款基于<span>web</span>的应用。我们很喜欢这个新想法，并以此为公司命名：<span>Viaweb</span>，因为我们的软件不是桌面软件而是通过网络来运行的。</p>
<p>关于这个软件，另一件特别之处就是它主要用<span>Lisp</span>写就。它是面向大众用户的<span>Lisp</span>程序的先锋，在此之前<span>Lisp</span>几乎都是用在大学和实验室的象牙塔里。<span>[1]</span></p>
<p><strong><span>The Secret Weapon</span></strong></p>
<p><span>秘密武器</span></p>
<p><span>Eric Raymond</span>写过一篇文章<span>&ldquo;</span>如何成为黑客<span>&rdquo;</span>，文中他教导黑客学前班的同学如何选择语言。他建议以<span>Python</span>和<span>Java</span>起步－因为容易学。严肃的黑客要修改<span>Unix</span>就得学<span>C</span>语言。最后，真正严肃的黑客应该考虑学习<span>Lisp:</span></p>
<p><span>&nbsp;&ldquo;</span>悟道时那种深刻的醍醐灌顶的感受是<span>Lisp</span>值得学习的一个原因；这个体验会让你在后面的岁月里成为更好的程序员－即使你<span>&nbsp;&nbsp;</span>不常用<span>Lisp</span>写程序。<span>&rdquo;</span></p>
<p>这和常听到的学习拉丁语的论调很类似。学了不会帮你找到工作（语言学教授除外），但它会训练提高你的大脑，让你在用诸如英语之类的语言写作时能够得心应手。</p>
<p>但是，等一下。这个比喻并不普遍适用。学习拉丁语找不着工作是因为没人说拉丁语。如果你用拉丁语写作，没人能理解你。但是<span>Lisp</span>是计算机语言，计算机可不挑剔程序员用什么语言。</p>
<p>如果像他说的，<span>Lisp</span>能让你成为更好的程序员，为啥不用呢？如果一个画家弄了一杆能让他下笔犹如神的画笔，在我看来，他画啥画都想用的，不是吗？我不是要取笑<span>Eric Raymond</span>。总的来讲，他的建议很好。他关于<span>Lisp</span>的说法基本是传统观点。但是这个传统观点自相矛盾：<span>Lisp</span>会让你成为更好的程序员，但你不会去用它。</p>
<p>为什么不呢？毕竟编程语言只是工具。如果<span>Lisp</span>写的程序更好的话，你就应该用它。如果用它写得烂，那谁还稀罕呢？</p>
<p>这不只是理论上的问题。软件行业竞争残酷－优胜劣汰。其他条件相同，软件写的又快又好公司会把对手挤垮。当你开始创业时，会对这一点深有体会。创业公司常处于要么盆满钵满要么一穷二白的位置。你最终要么赚翻，要么潦倒。如果你对技术押错宝了，竞争对手就会来灭掉你。</p>
<p><span>Robert</span>和我都精于<span>Lisp</span>，我们没有理由不相信自己的直觉而弃用<span>Lisp.&nbsp;</span>我们知道其他人都在用<span>C++</span>和<span>Perl</span>写软件。我们也知道这没啥大不了的。如果你选择那样的技术，就要在<span>Windows</span>上跑。选择技术时，必须忽略其他人在用什么，只考虑什么能工作得最好。</p>
<p>这在创业公司里更为适用。大公司里，你可以像其他所有大公司一样做事。但是创业公司里，你不能亦步亦趋。我不认为很多人意识到这一点了（即使是创业公司里的家伙们）。</p>
<p>大公司每年平均增长<span>10%</span>。所以你要是掌管一个大公司的话，你按照大公司的通用做事方式，你也就种瓜得瓜，种豆得豆－得到<span>10%</span>的增长。</p>
<p>创业公司里的情况也一样。如果你按照大多数创业公司的方式去做事，你也就只能期望业绩达到平均水平。这里的问题在于，平均水平意味着你要关门大吉。创业公司的成活率是大大低于<span>50%</span>的。所以，如果你开公司，最好有点与众不同。否则，麻烦就大了。</p>
<p><span>1995</span>年那会，我们知道一个竞争者尚未参透的秘密（现在也有好多蒙在鼓里呢）：如果你的软件在服务器端运行，就可以用任何你想用的语言。要是写桌面应用，很强势的一个观点就是要用操作系统的语言写应用。十年前，写应用这意味着用<span>C</span>语言写。但是，对于基于<span>Web</span>的软件，而你又有语言和操作系统的源码时，你可以用任何想用的语言。</p>
<p>然而，语言选择的自由是把双刃剑。现在你可以选了，你得思考选哪一个。那些拒绝变化的鸵鸟公司危险了：它们的对手可没有把头埋进沙子。</p>
<p>你会选哪个语言呢？我们选择<span>Lisp.&nbsp;</span>很重要的一点就是，这个市场上快速开发很重要。我们都白手起家，一个公司要是能比对手更早的做完新特性就很有优势。我们知道<span>Lisp</span>用于快速开发相当合适，而基于服务器的应用会放大这个优势－因为软件写完就可以立即发布。</p>
<p>如果其他公司不想用<span>Lisp,&nbsp;</span>真好。这在技术上会让我们有一个优势，能帮上忙的来者不拒。当我们创立<span>Viaweb</span>时，我们没有商业经验，不懂得市场推广，招聘员工，融资或者吸引用户。我们几个甚至都没工作过。我们唯一玩的转的就是写软件。我们寄希望于此。软件开发方面的任何优势，我们都不会放过。</p>
<p>你可以说采用<span>Lisp</span>是一个试验。我们的算盘是这样打的：如果我们用<span>Lisp</span>，我们功能会开发的比对手快，也可以做一些他们做不到的事情。<span>Lisp</span>很高层，我们就不需要大的开发组，我们的开销就很小。如果行得通，我们就能提供物美价廉的产品，还能盈利。最终，赢得所有用户，我们的对手则失掉用户最终关门。这就是我们当时希望的过程。</p>
<p>试验的结果如何？居然行得通。我们最终遇见了很多竞争者，<span>20</span>～<span>30</span>个吧，但没有一个能和我们针尖对麦芒。我们服务器上跑着一个<span>&ldquo;</span>所见即所得<span>&rdquo;</span>的在线商店编辑器，用起来却和桌面应用没啥差别。我们的对手们用的是<span>CGI</span>脚本。功能上我们总能先他们一步。有时，绝望中的对手想增加几个我们没有的功能。但是<span>Lisp</span>的开发周期很快，我们可以在他们发布软文宣传的一两天之内就复制一个新功能。当记者们读到他们的公关稿然后打电话给我们来问时，我们也有这个功能了。</p>
<p>我们的竞争对手也许觉得我们有什么秘密武器－能够读到他们脑子里的计划。实际上我们没有，比他们想的要简单。没人泄密他们的新功能，我们只是比任何人预期的开发速度更快而已。</p>
<p>我九岁时看过一部<span>The Day of the Jackal,&nbsp;</span>由<span>Frederick Forsyth</span>执导<span>.&nbsp;</span>主角是个刺客，要去刺杀法国总统。他必须通过警察，上到一个公寓能够俯瞰总统的行车路线。他乔装成一个跛老头，警察根本没有注意到他。</p>
<p>我们的秘密武器也差不多。我们用一个怪异的人工智能语言写软件，语法难看，充斥着括号。很多年以来，对<span>Lisp</span>的这种描述让我很不自在。现在，却成了我们的优势。商业上，拥有一项对手根本不懂的技术是无价的，正如战争一样，出其不意和厉兵秣马一样重要。</p>
<p>嗯，我有点窘：开发<span>Viaweb</span>时，公开场合我对<span>Lisp</span>只字未提。我们不向媒体说，如果你在网站上搜，也就只能找到我简历里提到的两本书。这是有意为之。如果他们不知道或者不关心我们用什么开发，我也乐于保持现状。<span>[2]</span></p>
<p>理解我们技术最好的是我们的客户。他们不关心<span>Viaweb</span>用什么写的，但是他们注意到软件跑得很好。几分钟就能建好一个漂亮的在线商店。然后，口碑就传开了，用户越来越多。<span>1997</span>年底时，我们有<span>500</span>个用户。六个月后，<span>Yahoo</span>买我们时，有了<span>1070</span>个用户。今天，成了<span>Yahoo Store</span>的<span>Viaweb</span>还统治着市场，是<span>Yahoo</span>产品线中很能盈利的一员。那些由<span>Viaweb</span>建成的商店成了<span>Yahoo Shopping</span>的基础。我<span>1999</span>年离开<span>Yahoo</span>，我不知道用户数量的具体数字，但是最近一次听到的是大约<span>20</span>，<span>000.</span></p>
<p><strong><span>The Blub Paradox</span></strong></p>
<p><strong><span>Blub</span></strong><span>困境</span></p>
<p><span>Lisp</span>到底强在哪儿？如果<span>Lisp</span>真那么棒，为啥没人用呢？听起来文绉绉的问题，实际上答案很直接。<span>Lisp</span>很棒不是因为某些痴迷者才能看到的品质，而是因为它就是所有语言中最强大的。没有普及的原因是选择编程语言不仅仅是个技术问题，而且是思维习惯－再没有比思维习惯改变得更慢得东西了。当然，这两个答案都需要解释。</p>
<p>我以一个不那么惊世骇俗的论断开始：编程语言的能力各有千秋。</p>
<p>高级语言比机器语言强大－这是个不争的事实。如今大多数程序员都赞成<span>&rdquo;</span>通常不要用机器语言写程序<span>&ldquo;</span>的观点。相反，你应当用高级语言，然后用编译器把程序编成机器语言。这个想法已经为硬件设计所采纳：自<span>80</span>年代起，指令集就专为编译器设计而不那么考虑我们程序员了。</p>
<p>人人都知道你的程序要是全用机器语言写就是个错误。但是另外一个原则却不为人熟知：如果你要从一堆语言里挑一个出来（其他条件都相同的情况下），要是不选择最强大的－这也是个错误。<span>[3]</span></p>
<p>这个原则也有很多例外。如果你的程序要和另外一个用某种语言写的程序打交道，那么通常新程序采用同样的语言是个好选择。如果你的程序只是要干点简单的活，比如数据处理或者位操作之类的，你可以用稍微低级一点的语言，还能带来速度上的优势。如果你写一个试验原型，你最好找库函数能满足要求的随便什么语言。但是大体来讲，对于应用软件，你需要用最强大的（也不太慢的）语言，其他的选择都是错误－这一定程度上和用机器语言写程序是一码事。</p>
<p>你知道机器语言很低级。但是，至少某种社会共识认为高级语言通常被认为是一样强大的。但事实并非如此。<span>&ldquo;</span>高级语言<span>&rdquo;</span>这个技术词汇实际上没有表明任何确定的东西。并没有一个位于机器语言和高级语言之间的分水岭。所有语言都位于一个由不同抽象能力构成的谱系<span>[4]</span>之中：从最强大的语言到机器语言，位置反映着语言本身的能力的差别。</p>
<p>拿<span>Cobol</span>来说，它是个高级语言－因为它能被编译成机器语言。真有人会跳出来辩护说<span>Cobol</span>和<span>Python</span>一样强吗？它要比<span>Python</span>更接近机器语言。</p>
<p>或者<span>Perl4</span>又如何呢？<span>Perl4</span>到<span>Perl5</span>之间，词法闭包被加进来了。大多数<span>Perl</span>黑客都同意<span>Perl5</span>比<span>Perl4</span>更强了。但是，一旦你同意这一点，你也就同意了一个高级语言比另一个更强大。直接的推论就是，除了特殊情况，你应当用最强大的语言。</p>
<p>然而现实中这个想法很少能实现它的结论。过了一定的年龄，程序员很少再会主动的更换语言了。他们手上碰巧用起来的随便什么语言，都被奉为圭臬。</p>
<p>程序员对于喜好的语言偏爱有加，不能自拔。我不打算伤任何人的感情，所以解释观点时，我用一个虚构的语言：<span>Blub</span>。<span>Blub</span>位于抽象谱系的中间，它不是最高级的语言，但也比<span>Cobol</span>和机器语言强。</p>
<p>实际上，我们虚构的<span>Blub</span>程序员不会用机器码或者<span>Cobol</span>：当然他们不会去写机器码－那是编译器该干的事情。对于<span>Cobol</span>，他们纳闷那些人是怎么用这语言干活的－<span>&nbsp;Cobol</span>连<span>x</span>功能都没有（<span>x</span>是一个<span>Blub</span>的功能）。</p>
<p>只要我们的<span>Blub</span>程序员朝下看，他就知道在朝下看－比<span>Blub</span>弱的语言一眼就能看出来，因为它们缺少一些<span>Blub</span>的功能。但是如果向上看，他不会意识到。他认为所看到的都是些怪异的语言。他也许会觉得看到的语言都和<span>Blub</span>差不多，只是花哨的东西太多。<span>Blub</span>对他就够好了－因为，他用<span>Blub</span>思考。</p>
<p>当我们切换到使用更高级的语言的程序员的视角，我们会发现他朝下会看到<span>Blub</span>：你怎么能用<span>Blub</span>干活呢？它连<span>y</span>功能都没有哎。</p>
<p>推理一下，只有理解最强大的语言的程序员才能一览众山，看到所有语言能力间的差别。（这也许就是<span>Eric Raymond</span>说<span>Lisp</span>能让你成为一个更好的程序员的意思。）你不能相信其他人的观点，因为<span>Blub</span>困境：他们对自己碰巧用上的语言很满意，因为这语言描绘了他们思考程序的方式。</p>
<p>我从自己的经验里知道这一点，高中时我用<span>Basic</span>写程序。这语言甚至都不支持递归。现在难以想象写程序不用递归。可那时，我可不稀罕。我用<span>Basic</span>思考，我写得很顺，我所触及皆以掌握。</p>
<p><span>Eric Raymond</span>所推荐的<span>5</span>种语言位于能力谱系的不同位置。它们的相对位置如何讨论起来比较敏感。我要说的是，我认为<span>Lisp</span>最高。要支持我的观点，我要告诉你一样其它<span>4</span>种语言都没有的东西：离了宏，你咋能编程呢？<span>[5]</span></p>
<p>很多语言都有叫做宏的东西。但是<span>Lisp</span>的宏独树一帜。信不信由你，宏和括号联系紧密。<span>Lisp</span>的设计者把那一堆括号加进来可不是为了标新立异。对于<span>Blub</span>程序员，<span>Lisp</span>看起来很怪。但是那些括号事出有因。它们是<span>Lisp</span>与其它语言本质区别的外在表现。</p>
<p><span>Lisp</span>代码由<span>Lisp</span>数据对象构成。不是在像<span>&rdquo;</span>源码文件由字符构成<span>&ldquo;</span>或者<span>&rdquo;</span>字符串也是该语言支持的数据类型之一<span>&ldquo;</span>这样的浅显的层次上：在由解析器读进内存后，<span>Lisp</span>代码就由你能遍历的数据结构构成了。</p>
<p>如果你了解编译器的工作原理，其实解析器干的活不多：要说<span>Lisp</span>的语法奇怪，还不如说<span>Lisp</span>没有语法。你写程序实际上是在写语法树－而其它语言需要编译器生成这种内部表示。你的程序完全可以存取这些语法树。你可以写程序去操作它。在<span>Lisp</span>里，这些程序叫做宏。它们是写程序的程序。</p>
<p>写程序的程序？你哪天才能用得到啊？如果你用<span>Cobol</span>思考，不常用。而用<span>Lisp</span>思考的话，答案就是：天天都用。这里要是我能举个例子说明就好了。但是这样对于不懂<span>Lisp</span>的人就是在废话了；要是从头到尾讲明白这里篇幅也不够，在<span>Ansi Common Lisp</span>里我的进度很快，但也到<span>160</span>页才开始讲宏。</p>
<p>但我想给一点有说服力的论据。<span>Viaweb</span>的编辑器代码里有<span>20</span>～<span>25%</span>的宏。宏比普通的<span>Lisp</span>程序难写，不该用的时候用就是画蛇添足。所以我们代码里的每个宏都有用。这意味着<span>20</span>～<span>25%</span>的代码是其它语言没法容易做到的。然而，挑剔的<span>Blub</span>程序员也许会找找我所声称的<span>Lisp</span>的神秘力量，这一堆宏应该能让他们迷惑不已。我们写这些宏不是为了自娱自乐－我们是个小创业公司，我们必须疯狂写程序，这样才能与竞争对手之间构筑技术上的壁垒。</p>
<p>怀疑的人会说这有什么联系吗？我们代码里的一大块是在做其它语言很难做到的事情，发布的软件做了很多竞争对手的软件没法做到的事情。也许这其中有联系。我鼓励你顺着这条线索再走走。拄着拐杖的跛老头也许还有更多去了解。</p>
<p><strong><span>Aikido for Startups</span></strong></p>
<p><span>创业公司的合气道</span></p>
<p>但是我不期望能让任何人（过了<span>25</span>岁）去学<span>Lisp</span>。这篇文章的目的不是要改变谁的思想，而是让那些有兴趣用<span>Lisp</span>的人更加确信－这些人知道<span>Lisp</span>很强大，但是因为它应用不广泛而有所顾虑。在竞争中，这是个优势。如果你的竞争对手不了解，<span>Lisp</span>的力量会加倍。</p>
<p>如果你想在创业公司里用<span>Lisp</span>，不用担心它不流行。你应当期望保持现状。事实也如此。程序设计语言的天性就是让人们乐于用它。计算机硬件的发展比个人习惯的发展快得多，程序设计的实践通常比处理器的进步落后<span>10</span>～<span>20</span>年。在<span>MIT</span>，他们<span>60’</span>就开始用高级语言写程序了，但是很多公司到了<span>80’</span>还在用机器语言。我打赌，很多人会一直用机器语言写下去，直到有一天，处理器换成了<span>RISC</span>指令集－就像急着下班的酒吧服务员急着关门一样，端掉这些人的饭碗。</p>
<p>通常，技术进步很快。但是程序设计语言不同：它不只是技术，它是程序员思考的工具。语言是技术和信仰的混合体<span>[6]</span>。于是，位于中间的语言（也就是中级程序员用的那些语言）动得跟冰山一样慢。<span>60’</span>由<span>Lisp</span>引入的垃圾回收功能，现在开始被接受。词法闭包，由<span>Lisp</span>在<span>70’</span>引入的，现在其它语言还没有广泛采纳。<span>60’</span>中<span>Lisp</span>引入的宏，现在还是处女地。</p>
<p>很明显，中间的语言族有着巨大的惯性。我不认为你能和这个力量对抗。相反，你要向合气道的选手学习：以彼之道，还治彼身。</p>
<p>如果你在大公司工作，这不太容易。你很难说你的服秃顶上司同意用<span>Lisp</span>写东西，他刚才才读到另一种语言新鲜出炉（就像<span>Ada</span>二十年前那样），正要征服世界。但是你要是为创业公司工作，没有秃顶老板干涉，你就能像我们那样化解<span>Blub</span>困境，转为自己的优势：你可以用那些黏糊在中间语言的竞争者不能采用的技术。</p>
<p>如果你为创业公司工作，这儿有个估量对手的妙招：读读他们的招聘职位列表。他们网站上其它的东西无非是些股票图片和乏味的说明，但是招聘职位却必须反映他们要找的人，否则会引来一堆无关的求职者。</p>
<p>在<span>Viaweb</span>工作的时候，我读了不少职位描述。大约每个月都有一个新的竞争对手加入这个行当。检查了他们的在线<span>Demo</span>后，我做的第一件事就是看看他们的招聘页。过了几年，我就知道要当心哪家。工作描述里要是<span>IT</span>类的成分越多，这家公司就越不构成威胁。对我们最安全的就是那些要求<span>Oracle</span>经验的，永远都不用担心他们。他们要是招聘<span>C++</span>或者<span>Java</span>开发者，也不用担心。但是要是找的是<span>Perl</span>或者<span>Python</span>程序员，就有点威胁了－这公司至少在技术方面是由真正的黑客掌管的。要是当初我看见一家招<span>Lisp</span>黑客的，我一定会忧心忡忡的。</p>
<p>－－－－－</p>
<p>注：</p>
<p><span>[1] Viaweb</span>一开始有两块：编辑器（用<span>Lisp</span>写的，客户用来建站）和订单系统（用<span>C</span>写的，处理订单）。第一版主要是<span>Lisp,</span>因为订单系统很小。后来增加了两个模块：<span>C</span>写的图片生成器以及<span>Perl</span>写的结算工具。</p>
<p><span>2003</span>年一月，<span>Yahoo</span>发布了新的编辑器，用<span>C++</span>和<span>Perl</span>写的。也很难讲这程序就不再是用<span>Lisp</span>写的了：因为要把它翻译成<span>C++</span>，他们先得写一个<span>Lisp</span>解释器－页面生成模板的代码据我所知还是<span>Lisp</span>的。（参考<span>Greenspun’s Tenth Rule</span>。）</p>
<p><span>[2] Robert Morris</span>说我没必要那么保密。因为即使竞争对手知道我们用<span>Lisp</span>，他们也不会理解原因的：<span>&rdquo;</span>如果他们足够聪明，那他们应当已经在用<span>Lisp</span>了。<span>&ldquo;</span></p>
<p><span>[3]&nbsp;</span>所有语言在图灵相等这一层上是一样强大的。但是这和程序员的意思不一样。（没人想在图灵机上写程序。）程序员在意的语言的能力也许不能形式化的定义，但一种解释就是，你想要在弱的语言里的要某种强语言的功能，就只能用弱语言去写一个解释器。如果<span>A</span>语言由一个操作可以把字符串里的空格移走，而<span>B</span>语言没有，这并不意味着<span>B</span>语言弱，因为你可以写个函数来完成这件事。但是要是<span>A</span>支持递归，而<span>B</span>不支持，这你就不好写个库函数来完成了。</p>
<p><span>[4]&nbsp;</span>对<span>Nerd</span>们的注解：可能是个格，顶尖；形状不重要，这里至少有个偏序关系。</p>
<p><span>[5]&nbsp;</span>把宏当作一个单独的功能有点误导。实践中，宏的作用通常由其它一些<span>Lisp</span>特性比如词法闭包以及<span>rest</span>参数大大加强。</p>
<p><span>[6]&nbsp;</span>这样，比较编程语言要么挑起信仰口水战要么就只能在绝对中立的教材里，这只能是人类学的工作了。想追求平静，保护自己的所有的人会避免这个话题。但是，这问题只是一半和信仰相关；还有值得研究的东西，特别是你要设计一个新语言时。</p>
<p>译注：</p>
<p>[1] 翻译时中英混排，完成时提取中文可以用grep:&nbsp;</p>
<p>&nbsp;</p>
<p>from:<a href="http://article.yeeyan.org/view/11304/49653" target="_blank" rel="noopener">http://article.yeeyan.org/view/11304/49653</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2010/12/11/巧用qmake工具生成专业的makefile/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="三闻鱼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Submarine">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2010/12/11/巧用qmake工具生成专业的makefile/" itemprop="url">巧用qmake工具生成专业的makefile</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2010-12-11T11:58:00+08:00">
                2010-12-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>问题描述</strong></p>
<p>一般来说在Linux下编程写个测试程序，都需要制作一个makefile文件，但是如果自己手动编写每个还是比较麻烦，而且看上去也不太专业。而如果用autoconf工具生成也还是需要加入一些手动操作，也不是很方便。</p>
<p><strong>解决方法</strong></p>
<p>利用QT程序里的qmake工具，qmake工具是QT 开发环境中的工具，它可以根据文件夹下的文件生成.pro文件，这个文件类似于vs的.vcproject，然后再根据这个.pro文件生成makefile文件。</p>
<p><strong>操作步骤</strong></p>
<p>安装qmake工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install qt4-qmake</span><br></pre></td></tr></table></figure>
<p><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12pt;"><span style="font-size: 13px; line-height: 19px; white-space: pre;">在src文件夹下执行</span></span></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qmake -project --生成.pro文件 qmake --根据.pro文件生成makefile make</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<p><strong>注意</strong></p>
<p>由于qmake是QT的工具，所以它会在.pro中加入qt的几个默认库，如果你不想下载这些库，可以在.pro文件中添加加下面两句，去除对默认库的引用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONFIG -= qt QT -= gui core</span><br></pre></td></tr></table></figure>
<p>最后附上pro文件的配置文档：</p>
<p><a href="http://doc.qt.nokia.com/4.6/qmake-variable-reference.html" target="_blank" rel="noopener">http://doc.qt.nokia.com/4.6/qmake-variable-reference.html</a></p>
<p>当然如果要生成复杂的makefile文件还是要通过autoconf类似的工具：</p>
<p><a href="http://www.chinaunix.net/jh/4/782832.html" target="_blank" rel="noopener">http://www.chinaunix.net/jh/4/782832.html</a></p>
<p>&nbsp;</p>
<p>虽然这篇文章内容比较简单，但是应该能给大家编写测试代码带来一些方便，所以就发到首页了，希望能给大家带来帮助。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2010/10/10/QT中拖拽的实现（附示例代码）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="三闻鱼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Submarine">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2010/10/10/QT中拖拽的实现（附示例代码）/" itemprop="url">QT中拖拽的实现（附示例代码）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2010-10-10T18:22:00+08:00">
                2010-10-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>QT中的Drag and Drop的详细介绍参见：<a href="http://doc.qt.nokia.com/4.0/dnd.html" target="_blank" rel="noopener">http://doc.qt.nokia.com/4.0/dnd.html</a></p>
<p>下面主要介绍一下Drag and Drop的Demo(<a href="http://u.115.com/file/f5a4c1ed9c" target="_blank" rel="noopener">下载</a>)，先附上一份效果图：</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chinese-zmm/WindowsLiveWriter/QT_F546/%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%87_2.png" target="_blank" rel="noopener"><img src="http://images.cnblogs.com/cnblogs_com/chinese-zmm/WindowsLiveWriter/QT_F546/%E6%9C%AA%E5%91%BD%E5%90%8D%E5%9B%BE%E7%89%87_thumb.png" alt="未命名图片" title="未命名图片"></a> </p>
<p>&nbsp;</p>
<p>这是一个拼图的Demo，左边是原图，右边是打散的图，拖动小方格可以实现不同的方格内的图片交换，此外程序还支持手动拖入原图片。</p>
<p>代码中主要的类是一个<strong>DragWidget</strong>。</p>
<p>它实现了以下几个方法。</p>
<ul>
<li>void dragEnterEvent(QDragEnterEvent <em>dragEvent);<br>void dragLeaveEvent(QDragLeaveEvent </em>dragEvent);<br>void dragMoveEvent(QDragMoveEvent <em>dragEvent);<br>void dropEvent(QDropEvent </em>dragEvent);<br>void mousePressEvent(QMouseEvent *mouseEvent);</li>
</ul>
<p>Drag执行的流程是： </p>
<p>Drag是从drag-&gt;exec()开始的，此时将开启进入一个新的事件循环，然后在拖动的过程中会在下面三个事件中交替： </p>
<p>&nbsp;</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chinese-zmm/WindowsLiveWriter/QT_F546/DragCircle_2.png" target="_blank" rel="noopener"><img src="http://images.cnblogs.com/cnblogs_com/chinese-zmm/WindowsLiveWriter/QT_F546/DragCircle_thumb.png" alt="DragCircle" title="DragCircle"></a></p>
<p>其中DragEnter是有拖动进入该Widget时触发的，对应的DragLeave则是拖动离开时触发的，而DragMove就是鼠标拖动的时候触发的。</p>
<p>最后当鼠标释放的时候将触发dragEvent，此时将决定拖拽的结果。</p>
<p>回头看一下Drag的触发，和大多数系统一样，一个Drag可能是从控件外触发的，即将外部的数据拖入，也可以是从控件内部触发，即手动生成一个QDrag对象。在示例代码中，这两种方式都会有接触。</p>
<p>&nbsp;</p>
<p>再聊聊拖动的机制，其实拖动就是将一处的数据移动或者复制到另外一处，在QT中拖动所承载的数据使用QMimeData表示的，它可以用来表示许多<strong>Mime Type</strong>的集合。一个Mime Type即有format和data两部分组成，format即指示了如何解析对应的data。更详细的定义可以参考：<a href="http://en.wikipedia.org/wiki/MIME" target="_blank" rel="noopener">http://en.wikipedia.org/wiki/MIME</a>。</p>
<p>&nbsp;</p>
<p>最后简单地介绍一些重要的代码片段</p>
<p>DragWidget中使用三个数组来表示对于的数据：</p>
<blockquote>
<p>QList&lt;QPixmap&gt; mImgList;&nbsp;&nbsp; <span style="color: #ff0000;">//image per block<br></span>QList&lt;QRect&gt;&nbsp;&nbsp; mPieceList; <span style="color: #ff0000;">//position per block</span><br>QList&lt;QPoint&gt;&nbsp; mPosList;&nbsp;&nbsp; <span style="color: #ff0000;">//correct per image</span></p>
</blockquote>
<p>void mousePressEvent(QMouseEvent *mouseEvent);</p>
<p>&nbsp;</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">QPoint point = mPosList[find];</span><br><span class="line">QPixmap image = mImgList[find];</span><br><span class="line">QRect rect = mHighlightRect;</span><br><span class="line">mPieceList.removeAt(find);<span class="comment">//.remove(mHighlightRect);</span></span><br><span class="line">mImgList.removeAt(find);</span><br><span class="line">mPosList.removeAt(find);</span><br><span class="line"><span class="keyword">if</span> (checkMatch(rect, point))</span><br><span class="line">     --mInPlace;</span><br><span class="line">QByteArray data;</span><br><span class="line"><span class="function">QDataStream <span class="title">stream</span><span class="params">(&amp;data, QIODevice::WriteOnly)</span></span>;</span><br><span class="line">stream &lt;&lt; image &lt;&lt; point;</span><br><span class="line">QDrag* drag = <span class="keyword">new</span> QDrag(<span class="keyword">this</span>);</span><br><span class="line">QMimeData* mimeData = <span class="keyword">new</span> QMimeData;</span><br><span class="line">mimeData-&gt;setData(<span class="string">"application/x-dragitemdata"</span>, data);</span><br><span class="line">drag-&gt;setMimeData(mimeData);</span><br><span class="line">drag-&gt;setPixmap(image);</span><br><span class="line">drag-&gt;setHotSpot(mouseEvent-&gt;pos() - mHighlightRect.topLeft());</span><br><span class="line"><span class="keyword">if</span> (<span class="number">0</span> == drag-&gt;exec(Qt::MoveAction))&#123;</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<p>在mousePress的时候开启一个Drag，定义一个自己的Mime Type-&gt;&ldquo;application/x-dragitemdata&rdquo;，将需要的数据打包进去。 </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (dragEvent-&gt;mimeData()-&gt;hasFormat(<span class="string">"application/x-dragitemdata"</span>))</span><br><span class="line">&#123;</span><br><span class="line">        QRect targetRect = targetBlock(dragEvent-&gt;pos());</span><br><span class="line">        QByteArray data = dragEvent-&gt;mimeData()-&gt;data(<span class="string">"application/x-dragitemdata"</span>);</span><br><span class="line">        <span class="function">QDataStream <span class="title">stream</span><span class="params">(data)</span></span>;</span><br><span class="line">        QPixmap image;</span><br><span class="line">        QPoint point;</span><br><span class="line">        stream &gt;&gt; image &gt;&gt; point;</span><br><span class="line">        mImgList.append(image);</span><br><span class="line">        mPieceList.append(targetRect);</span><br><span class="line">        mPosList.append(point);</span><br><span class="line">        <span class="keyword">if</span> (checkMatch(targetRect, point))</span><br><span class="line">            ++mInPlace;</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<p>在drop消息中对数据进行解包，并判断是否放置到了合适的位置。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2010/08/21/Tiled-地图编辑器分析（QT平台）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="三闻鱼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Submarine">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2010/08/21/Tiled-地图编辑器分析（QT平台）/" itemprop="url">Tiled 地图编辑器分析（QT平台）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2010-08-21T09:16:00+08:00">
                2010-08-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Tiled 是一款地图编辑软件，它的网址是：<a href="http://www.mapeditor.org/" target="_blank" rel="noopener">http://www.mapeditor.org/</a>（ 不过好像要用代理才能访问）。Wiki的网址是：<a href="http://sourceforge.net/apps/mediawiki/tiled/index.php?title=Main_Page" title="Main_Page" target="_blank" rel="noopener">http://sourceforge.net/apps/mediawiki/tiled/index.php?title=Main_Page</a>。它的上一版是用Jave实现，有兴趣的也可以去看一下。</p>
<p>&nbsp;</p>
<h2 id="Tiled现在包含的功能有："><a href="#Tiled现在包含的功能有：" class="headerlink" title="Tiled现在包含的功能有："></a>Tiled现在包含的功能有：</h2><ol>
<li><strong><font color="#000080">General purpose tile map editor with XML-based map format</font></strong>  </li><li>Supports orthogonal and isometric maps  </li><li>Custom objects can be placed with pixel precision  </li><li><strong><font color="#000080">Full undo/redo and copy/paste support</font></strong>  </li><li>Add custom properties to tiles, layers, objects or the map  </li><li>Automatically reloads tilesets when changed externally  </li><li>Resize or offset your tile map later as needed  </li><li>Efficient tile editing tools like stamp and fill brushes  </li><li>Supports input/output plugins to open and save files in custom formats </li>
</ol>
<p>本文将重点描述Tiled的整体结构，以及1, 4功能的实现（本文分析的是它的0.1版）。</p>
<p>&nbsp;</p>
<h2 id="开发环境的搭建"><a href="#开发环境的搭建" class="headerlink" title="开发环境的搭建"></a>开发环境的搭建</h2><p>首先从<a href="http://sourceforge.net/projects/tiled/" target="_blank" rel="noopener">http://sourceforge.net/projects/tiled/</a> 上下载最新的源码。</p>
<p>用<a href="http://qt.nokia.com/products/developer-tools" target="_blank" rel="noopener">Qt Creator</a>打开源码中的pro文件。</p>
<p>下载zlib库，地址：<a href="http://www.zlib.net/" target="_blank" rel="noopener">http://www.zlib.net/</a>。</p>
<p>打开src下面的<strong>src.pro</strong>, 加入对zlib的引用：</p>
<blockquote>
<p>INCLUDEPATH += “D:\Program Files\GnuWin32\include”  </p><p>LIBS += -L”D:\Program Files\GnuWin32\lib” \<br>&nbsp;&nbsp;&nbsp; -lzlib </p>
</blockquote>
<p>点击build，泡杯茶回来便可看到程序的运行画面了，如下所示：  </p><p><a href="http://images.cnblogs.com/cnblogs_com/chinese-zmm/WindowsLiveWriter/Tiled_81F9/tiled_shotsnap_2.png" target="_blank" rel="noopener"><img src="http://images.cnblogs.com/cnblogs_com/chinese-zmm/WindowsLiveWriter/Tiled_81F9/tiled_shotsnap_thumb.png" alt="tiled_shotsnap" title="tiled_shotsnap"></a>  </p><p><strong>Note：</strong>源代码所在文件夹的路径中不能出现中文，否则编译会出错。</p>
<p>Tiled的使用说明可以参考如下两篇文章：</p>
<p><a href="http://silveiraneto.net/2009/01/11/game-map-edition-using-tiled/" target="_blank" rel="noopener">http://silveiraneto.net/2009/01/11/game-map-edition-using-tiled/</a></p>
<p><a href="http://www.raywenderlich.com/1163/how-to-make-a-tile-based-game-with-cocos2d" target="_blank" rel="noopener">http://www.raywenderlich.com/1163/how-to-make-a-tile-based-game-with-cocos2d</a></p>
<p>&nbsp;</p>
<h2 id="整体结构的介绍"><a href="#整体结构的介绍" class="headerlink" title="整体结构的介绍"></a>整体结构的介绍</h2><p>QT窗口的结构如下所示</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chinese-zmm/WindowsLiveWriter/Tiled_81F9/tiled_view_struct_2.png" target="_blank" rel="noopener"><img src="http://images.cnblogs.com/cnblogs_com/chinese-zmm/WindowsLiveWriter/Tiled_81F9/tiled_view_struct_thumb.png" alt="tiled_view_struct" title="tiled_view_struct"></a> </p>
<p>先说左边三个窗口：</p>
<p>层管理窗口：可以把层次分类进行管理，如建筑物和植物可以定义到不同的层次。</p>
<p>历史管理窗口：可以查看和撤销之前的操作。</p>
<p>色块管理窗口：显示外界导入的tileset，可以添加到客户区中。</p>
<p>这三个窗口利用QT的QDockWidget实现，所以默认具有停靠，移动的功能。</p>
<p>&nbsp;</p>
<p>再说左边的客户区，可以编辑map，这块是利用QT的GraphicsView图形引擎完成的，关于GraphicsView的介绍可以参考：</p>
<p><a href="http://doc.qt.nokia.com/4.6/graphicsview.html" target="_blank" rel="noopener">http://doc.qt.nokia.com/4.6/graphicsview.html</a>，对应到代码中就是MapView。</p>
<p>&nbsp;</p>
<p>下面看一下MainWindow类是如何管理这几个窗口的。</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/chinese-zmm/WindowsLiveWriter/TiledQT_EC02/Creek_2.jpg" target="_blank" rel="noopener"><img src="http://images.cnblogs.com/cnblogs_com/chinese-zmm/WindowsLiveWriter/TiledQT_EC02/Creek_thumb.jpg" alt="Creek" title="Creek"></a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="三闻鱼">
          <p class="site-author-name" itemprop="name">三闻鱼</p>
           
              <p class="site-description motion-element" itemprop="description">record tech & life</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">tags</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">三闻鱼</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


<div>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

本站总访问量 <span id="busuanzi_value_site_pv"></span> 次&nbsp&nbsp&nbsp
本站访客数<span id="busuanzi_value_site_uv"></span>人次
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
